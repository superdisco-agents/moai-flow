# Module: PR Templates

## Overview

Pull request body templates for MoAI Flow publications.

---

## Full Consolidation PR Template

```markdown
## Summary

This PR consolidates improvements identified through MoAI Flow workspace comparison.

### Collection Information
- **Collection ID**: {collection_id}
- **Consolidation ID**: {consolidation_id}
- **Source Workspace**: {source_workspace}
- **Compared Against**: {comparison_workspace}
- **Analysis Date**: {date}

---

## Changes Included

### Skills Added ({count})

| Skill | Score | Rationale |
|-------|-------|-----------|
{for each skill_added}
| {name} | {score}/100 | {rationale} |
{end for}

### Skills Merged ({count})

| Skill | Strategy | Details |
|-------|----------|---------|
{for each skill_merged}
| {name} | {strategy} | {details} |
{end for}

### Skills Enhanced ({count})

| Skill | Enhancement | Description |
|-------|-------------|-------------|
{for each skill_enhanced}
| {name} | {enhancement_type} | {description} |
{end for}

### Agents ({count})
{list or "No agent changes"}

### Commands ({count})
{list or "No command changes"}

---

## Learning Highlights

### Patterns Extracted

{for each pattern}
#### {pattern_name}
- **Category**: {category}
- **Description**: {description}
- **Could Apply To**: {applicability_list}
{end for}

### Improvement Scores Summary

| Category | Average Score |
|----------|---------------|
| Added Components | {avg_added_score}/100 |
| Merged Components | {avg_merged_score}/100 |

---

## Validation Results

### Pre-Consolidation
- [x] Sources accessible
- [x] Target writable
- [x] Git status clean
- [x] Learning report valid

### During Consolidation
- [x] All copies validated ({copy_count}/{copy_count})
- [x] All merges validated ({merge_count}/{merge_count})
- [x] All enhancements applied ({enhancement_count}/{enhancement_count})

### Post-Consolidation
- [x] All approved changes applied
- [x] No broken references
- [x] YAML frontmatter valid in all skills
- [x] No conflict markers remaining

---

## Files Changed

<details>
<summary>View file list ({file_count} files)</summary>

### Added
{for each file_added}
- `{path}`
{end for}

### Modified
{for each file_modified}
- `{path}`
{end for}

</details>

---

## Test Plan

### Manual Testing
- [ ] Review skill documentation for accuracy
- [ ] Verify examples work as documented
- [ ] Test any new scripts in `skills/*/scripts/`
- [ ] Check cross-references between components

### Automated Checks
- [ ] CI pipeline passes
- [ ] No linting errors
- [ ] Documentation builds successfully

---

## Rollback Plan

If issues are found after merge:

```bash
# Revert the merge commit
git revert -m 1 {merge_commit_sha}

# Or restore from backup
# Backups stored in .moai/flow/backups/{consolidation_id}/
```

---

## Related

- Learning Report: `.moai/flow/collections/{collection_id}/learning.json`
- Consolidation Audit: `.moai/flow/collections/{collection_id}/consolidation.json`
- Backup Location: `.moai/flow/backups/{consolidation_id}/`

---

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
```

---

## Simple Sync PR Template

```markdown
## Summary

Syncing components from {source_workspace} without full learning analysis.

### Reason for Simple Sync
{reason - e.g., "Minor updates only", "Time-sensitive fix", "Already reviewed manually"}

---

## Components Synced

### Skills
{list or "None"}

### Agents
{list or "None"}

### Commands
{list or "None"}

---

## Validation

- [x] Files copied successfully
- [x] No syntax errors
- [ ] Manual review recommended

---

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
```

---

## Hotfix PR Template

```markdown
## Summary

Urgent fix for {issue_description}.

---

## Issue

### What Was Wrong
{detailed description of the problem}

### Impact
{who/what was affected}

### How It Was Discovered
{how the issue was found}

---

## Fix

### Changes Made
{description of the fix}

### Files Changed
{list of files}

### Why This Fix
{rationale for the approach}

---

## Testing

### Verification Steps
1. {step 1}
2. {step 2}
3. {step 3}

### Results
- [x] Issue no longer reproducible
- [x] No regression in related functionality

---

## Rollback

If this fix causes issues:
```bash
git revert {commit_sha}
```

---

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
```

---

## PR Labels

### Standard Labels

| Label | Usage |
|-------|-------|
| `moai-flow` | All MoAI Flow PRs |
| `consolidation` | Full consolidation PRs |
| `sync` | Simple sync PRs |
| `hotfix` | Urgent fix PRs |
| `automated` | Generated by automation |

### Apply Labels

```bash
gh pr edit {pr_number} --add-label "moai-flow,consolidation,automated"
```

---

## Generating PR Body

```python
def generate_pr_body(consolidation_report: dict, learning_report: dict) -> str:
    """Generate PR body from reports."""

    # ... template filling logic ...

    return filled_template
```

### Using with gh CLI

```bash
# Store body in temp file for complex content
cat > /tmp/pr_body.md << 'EOF'
{generated content}
EOF

# Create PR
gh pr create \
  --title "feat(flow): Consolidate improvements" \
  --body-file /tmp/pr_body.md \
  --base main \
  --head "$BRANCH_NAME"
```
