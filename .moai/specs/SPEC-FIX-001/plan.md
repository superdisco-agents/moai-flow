---
id: SPEC-FIX-001
version: "1.0.0"
status: draft
created: "2025-11-18"
updated: "2025-11-18"
author: Claude Code
priority: high
---

# SPEC-FIX-001: êµ¬í˜„ ê³„íš ë° ê¸°ìˆ  ì „ëžµ

## 1. ë¬¸ì œ ë¶„ì„ ìš”ì•½

### ê·¼ë³¸ ì›ì¸
- **ìŠ¤í¬ë¦½íŠ¸ ë§ˆì´ê·¸ë ˆì´ì…˜**: `.moai/scripts/statusline.py` â†’ `uvx moai-adk statusline`
- **í™˜ê²½ ì´ìŠˆ**: uvx ìºì‹œ, config.json ê²½ë¡œ í•´ì„, íŒ¨í‚¤ì§€ import ì‹¤íŒ¨
- **ì¦ìƒ**: Claude Code ìƒíƒœí‘œì‹œì¤„ì— "Ver unknown" í‘œì‹œ

### ì˜í–¥ ë²”ìœ„
- **ëŒ€ìƒ**: ëª¨ë“  MoAI-ADK ì‚¬ìš©ìž (Personal/Team ëª¨ë“œ)
- **ì‹¬ê°ë„**: HIGH (ê°œë°œ ìƒì‚°ì„± ì§ì ‘ ì˜í–¥)
- **ë°°í¬ í™˜ê²½**: Claude Code SessionStart í›…

### ê¸´ê¸‰ë„ ë¶„ë¥˜
- **ë¹ ë¥¸ ìˆ˜ì • í•„ìš”**: 2-3ì‹œê°„ ì´ë‚´ í•´ê²° ê¶Œìž¥
- **ì˜í–¥ ë¯¸ë£¨ê¸° ë¹„ìš©**: í•˜ë£¨ì— ìµœì†Œ 2-3ì‹œê°„ ê°œë°œ ì‹œê°„ ë‚­ë¹„ ê°€ëŠ¥

---

## 2. í•´ê²° ì „ëžµ (4ë‹¨ê³„)

### Phase 1: í™˜ê²½ ì§„ë‹¨
**ëª©í‘œ**: ì •í™•í•œ ì›ì¸ íŠ¹ì • ë° ì§„ë‹¨ ê²°ê³¼ ë¬¸ì„œí™”

#### Phase 1-1: uvx ëª…ë ¹ì–´ í…ŒìŠ¤íŠ¸
```bash
# í…ŒìŠ¤íŠ¸ 1: ì§ì ‘ ì‹¤í–‰
uvx moai-adk statusline

# ì˜ˆìƒ ì¶œë ¥: ðŸ¤– Haiku 4.5 | ðŸ—¿ Ver 0.26.0 | ðŸ“Š +0 M26 ?9 | ðŸ”€ release/0.26.0
# ë¬¸ì œ ì¦ìƒ: ðŸ¤– Haiku 4.5 | ðŸ—¿ Ver unknown | ...
```

**ì§„ë‹¨ í•­ëª©**:
- uvx ëª…ë ¹ì–´ ì¡´ìž¬ ì—¬ë¶€
- íŒ¨í‚¤ì§€ ë¡œë“œ ì„±ê³µ ì—¬ë¶€
- ì¶œë ¥ í˜•ì‹ ë° ë²„ì „ ì •ë³´

#### Phase 1-2: config.json ê²€ì¦
```bash
# í…ŒìŠ¤íŠ¸ 2: íŒŒì¼ ì¡´ìž¬ í™•ì¸
cat .moai/config/config.json | jq '.moai.version'

# ì˜ˆìƒ ì¶œë ¥: "0.26.0"
# ë¬¸ì œ ì¦ìƒ: null, error, ë˜ëŠ” íŒŒì¼ ì—†ìŒ
```

**ì§„ë‹¨ í•­ëª©**:
- íŒŒì¼ ìœ„ì¹˜: `.moai/config/config.json`
- í•„ë“œ ì¡´ìž¬: `moai.version`
- ê°’ì˜ ì •í™•ì„±: "0.26.0"

#### Phase 1-3: íŒ¨í‚¤ì§€ ë²„ì „ í™•ì¸
```bash
# í…ŒìŠ¤íŠ¸ 3: ì„¤ì¹˜ëœ ë²„ì „ í™•ì¸
uvx moai-adk --version

# í…ŒìŠ¤íŠ¸ 4: íŒ¨í‚¤ì§€ ê²½ë¡œ í™•ì¸
python -c "import moai_adk; print(moai_adk.__file__)"

# í…ŒìŠ¤íŠ¸ 5: ì§ì ‘ ëª¨ë“ˆ ë¡œë“œ
python -c "from moai_adk.statusline.main import get_version; print(get_version())"
```

**ì§„ë‹¨ í•­ëª©**:
- ì„¤ì¹˜ëœ ëª¨ë“ˆ ìœ„ì¹˜
- íŒ¨í‚¤ì§€ ë²„ì „
- import ì„±ê³µ ì—¬ë¶€

### Phase 2: ìºì‹œ í´ë¦¬ì–´ ë° ìž¬ì„¤ì¹˜
**ëª©í‘œ**: ì˜¤ì—¼ëœ ìºì‹œ ì œê±° ë° ìµœì‹  ë²„ì „ ì„¤ì¹˜

#### Phase 2-1: uvx ìºì‹œ ì œê±°
```bash
# Step 1: moai-adk íŒ¨í‚¤ì§€ ìºì‹œë§Œ ì‚­ì œ
uvx cache clean moai-adk

# Step 2: ì „ì²´ uvx ìºì‹œ ì´ˆê¸°í™” (í•„ìš”ì‹œ)
rm -rf ~/.cache/uv/

# Step 3: ê²€ì¦
uvx --version
```

**íš¨ê³¼**:
- ì˜¤ëž˜ëœ íŒ¨í‚¤ì§€ ë²„ì „ ì œê±°
- ë‹¤ìŒ ì‹¤í–‰ ì‹œ PyPIì—ì„œ ìµœì‹  ë²„ì „ ë‹¤ìš´ë¡œë“œ

#### Phase 2-2: íŒ¨í‚¤ì§€ ìž¬ë™ê¸°í™”
```bash
# Step 1: í”„ë¡œì íŠ¸ ì˜ì¡´ì„± ê°•ì œ ìž¬ì„¤ì¹˜
uv sync --force

# Step 2: ìž ê¸ˆ íŒŒì¼ ìž¬ìƒì„± í™•ì¸
ls -la uv.lock

# Step 3: íŒ¨í‚¤ì§€ ì„¤ì¹˜ ìƒíƒœ í™•ì¸
uv pip list | grep moai-adk
```

**íš¨ê³¼**:
- ëª¨ë“  ì˜ì¡´ì„± ìµœì‹  ìƒíƒœë¡œ ë™ê¸°í™”
- ì†ìƒëœ ì„¤ì¹˜ íŒŒì¼ ìž¬êµ¬ì„±

#### Phase 2-3: ê²€ì¦
```bash
# ìž¬ì„¤ì¹˜ í›„ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸
uvx moai-adk statusline

# ì˜ˆìƒ ê²°ê³¼: "Ver unknown" í•´ê²° ì—¬ë¶€ í™•ì¸
```

### Phase 3: ì„¤ì • íŒŒì¼ ê²€ì¦
**ëª©í‘œ**: Claude Code ë° statusline ì„¤ì •ì´ ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸

#### Phase 3-1: Claude Code ì„¤ì • í™•ì¸
```bash
# 1. settings.jsonì—ì„œ statusLine ì„¹ì…˜ í™•ì¸
cat .claude/settings.json | jq '.statusLine'

# 2. ê¸°ë³¸ ì„¤ì • í™•ì¸
jq '.statusLine' .claude/settings.json | grep -E "enabled|format"

# ì˜ˆìƒ:
# {
#   "enabled": true,
#   "format": "{{model}} | {{version}} | {{git}} | {{branch}}"
# }
```

**ê²€ì¦ í•­ëª©**:
- statusLine.enabled = true
- format í•„ë“œ í¬í•¨
- ì˜¬ë°”ë¥¸ ìžë¦¬ í‘œì‹œìž

#### Phase 3-2: statusline ì„¤ì • íŒŒì¼
```bash
# 1. ì„¤ì • íŒŒì¼ ì¡´ìž¬ í™•ì¸
ls -la .moai/config/statusline-config.yaml

# 2. ë‚´ìš© í™•ì¸
cat .moai/config/statusline-config.yaml
```

**ê²€ì¦ í•­ëª©**:
- íŒŒì¼ ì¡´ìž¬ ì—¬ë¶€
- ì˜¬ë°”ë¥¸ YAML í˜•ì‹
- í•„ìˆ˜ í•„ë“œ í¬í•¨

#### Phase 3-3: í•„ìš”í•œ ì„¤ì • ì¶”ê°€
```bash
# 1. ëˆ„ë½ëœ ì„¤ì • í•­ëª© ì¶”ê°€
cat >> .moai/config/statusline-config.yaml <<EOF
# statusline ì„¤ì •
version_field: moai.version
config_path: .moai/config/config.json
timeout_seconds: 3
cache_enabled: true
cache_ttl_seconds: 3600
EOF

# 2. ê²€ì¦
uv run .moai/scripts/validate-config.py
```

### Phase 4: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
**ëª©í‘œ**: ëª¨ë“  ìš”êµ¬ì‚¬í•­ì´ ì¶©ì¡±ë˜ì—ˆëŠ”ì§€ ìµœì¢… ê²€ì¦

#### Phase 4-1: ìˆ˜ë™ í…ŒìŠ¤íŠ¸
```bash
# Test 1: ì§ì ‘ ì‹¤í–‰
echo "=== Direct execution test ==="
uvx moai-adk statusline
# ê¸°ëŒ€: ðŸ¤– Haiku 4.5 | ðŸ—¿ Ver 0.26.0 | ðŸ“Š +0 M26 ?9 | ðŸ”€ release/0.26.0

# Test 2: ë°˜ë³µ ì‹¤í–‰ (ìºì‹œ ížˆíŠ¸)
echo "=== Cache hit test ==="
time uvx moai-adk statusline
# ê¸°ëŒ€: 1ì´ˆ ì´ë‚´ ì‘ë‹µ

# Test 3: í™˜ê²½ ë³€ìˆ˜ í…ŒìŠ¤íŠ¸
echo "=== Environment variable test ==="
DEBUG=1 uvx moai-adk statusline
# ê¸°ëŒ€: ë””ë²„ê·¸ ì •ë³´ ì¶œë ¥ ê°€ëŠ¥
```

**ê²€ì¦ ê¸°ì¤€**:
- "Ver unknown" ë¯¸í‘œì‹œ âœ“
- ì •í™•í•œ ë²„ì „ ë²ˆí˜¸ í‘œì‹œ âœ“
- ì‘ë‹µ ì‹œê°„ 2ì´ˆ ì´ë‚´ âœ“

#### Phase 4-2: Claude Code ê²€ì¦
```bash
# Test 1: Claude Code ìž¬ì‹œìž‘
# â†’ bottom statuslineì— Ver 0.26.0 í‘œì‹œ í™•ì¸

# Test 2: ì—¬ëŸ¬ ì„¸ì…˜ ìƒì„±
# â†’ ê° ì„¸ì…˜ì—ì„œ ì •ìƒ í‘œì‹œ í™•ì¸

# Test 3: ìž¥ì‹œê°„ ìœ ì§€
# â†’ ì„¸ì…˜ ìœ ì§€ ì¤‘ ì§€ì†ì  ì •ìƒ ë™ìž‘ í™•ì¸
```

**ê²€ì¦ í•­ëª©**:
- SessionStart í›… ì •ìƒ ìž‘ë™
- ë©€í‹° ì„¸ì…˜ ë™ì‹œì„±
- ì§€ì†ì„± (ì—¬ëŸ¬ ì‹œê°„ ìœ ì§€)

#### Phase 4-3: ì§€ì†ì„± ê²€ì¦
```bash
# Test 1: ì„¸ì…˜ ìž¬ì‹œìž‘
# â†’ Claude Code ì¢…ë£Œ í›„ ìž¬ì‹œìž‘
# â†’ statusline ì •ìƒ í‘œì‹œ í™•ì¸

# Test 2: íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ ì‹œë®¬ë ˆì´ì…˜
# â†’ config.json ë²„ì „ ë³€ê²½ (0.26.0 â†’ 0.26.1)
# â†’ statusline ìž¬ì‹¤í–‰
# â†’ ìƒˆ ë²„ì „ ë°˜ì˜ í™•ì¸

# Test 3: ìºì‹œ ì œê±° í›„ ì‹¤í–‰
# â†’ uvx cache clean moai-adk
# â†’ statusline ì •ìƒ ìž‘ë™ í™•ì¸
```

---

## 3. ìƒì„¸ êµ¬í˜„ ê³„íš

### êµ¬í˜„ ìš°ì„ ìˆœìœ„
| ìš°ì„ ìˆœìœ„ | ìž‘ì—… | ì˜ˆìƒ ì‹œê°„ | ë‹´ë‹¹ |
|---------|------|---------|------|
| P0 (Critical) | Phase 1: í™˜ê²½ ì§„ë‹¨ | 5ë¶„ | QA/ê°œë°œìž |
| P1 (High) | Phase 2: ìºì‹œ í´ë¦¬ì–´ | 10ë¶„ | ì‹œìŠ¤í…œ |
| P2 (High) | Phase 3: ì„¤ì • ê²€ì¦ | 5ë¶„ | ì„¤ì • ê´€ë¦¬ |
| P3 (Medium) | Phase 4: ìµœì¢… í…ŒìŠ¤íŠ¸ | 5ë¶„ | QA |

### ë³‘ë ¬ ê°€ëŠ¥ ìž‘ì—…
```
Phase 1 (ì§„ë‹¨) â†’ Phase 2 (ìºì‹œ)
                    â†“
              Phase 3 (ì„¤ì • ê²€ì¦)
                    â†“
              Phase 4 (ìµœì¢… í…ŒìŠ¤íŠ¸)
```

**ì´ ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 15-20ë¶„

---

## 4. ê¸°ìˆ  ìŠ¤íƒ ë° ì˜ì¡´ì„±

| í•­ëª© | ë²„ì „ | ìš©ë„ |
|------|------|------|
| Python | 3.13.9+ | íŒ¨í‚¤ì§€ ëŸ°íƒ€ìž„ |
| moai-adk | 0.26.0+ | statusline í˜¸ìŠ¤íŠ¸ |
| uvx | 0.5.0+ | íŒ¨í‚¤ì§€ ì‹¤í–‰ ë„êµ¬ |
| uv | ìµœì‹  | ì˜ì¡´ì„± ê´€ë¦¬ |
| Claude Code | v4.0+ | ì‹¤í–‰ í™˜ê²½ |
| jq | 1.6+ | JSON íŒŒì‹± ë„êµ¬ |

---

## 5. ìœ„í—˜ ìš”ì†Œ ë° ì™„í™” ì „ëžµ

| ìœ„í—˜ | ê°€ëŠ¥ì„± | ì˜í–¥ | ì™„í™” ì „ëžµ |
|------|--------|------|---------|
| ìºì‹œ í´ë¦¬ì–´ í›„ì—ë„ ë¯¸ìž‘ë™ | ì¤‘ê°„ | ë†’ìŒ | Phase 3 ì„¤ì • ê²€ì¦ ê°•í™” |
| íŒ¨í‚¤ì§€ ë²„ì „ ë¶ˆì¼ì¹˜ | ë‚®ìŒ | ì¤‘ê°„ | uv.lock íŒŒì¼ ê²€ì¦ |
| config.json ê²½ë¡œ ë¬¸ì œ | ë‚®ìŒ | ë†’ìŒ | í™˜ê²½ ë³€ìˆ˜ ëŒ€ì²´ ê²½ë¡œ ì„¤ì • |
| ì„±ëŠ¥ ì €í•˜ (íƒ€ìž„ì•„ì›ƒ) | ë§¤ìš° ë‚®ìŒ | ì¤‘ê°„ | ìºì‹œ ë©”ì»¤ë‹ˆì¦˜ ê°•í™” |

---

## 6. í’ˆì§ˆ ê²Œì´íŠ¸ (TRUST 5)

### Test Coverage
- [ ] Phase 1-3 ê° ë‹¨ê³„ ìžë™í™” í…ŒìŠ¤íŠ¸
- [ ] Phase 2-3 ìºì‹œ/ì„¤ì • í…ŒìŠ¤íŠ¸
- [ ] Phase 4 í†µí•© í…ŒìŠ¤íŠ¸

### Readability
- [ ] ì§„ë‹¨ ì¶œë ¥ ëª…í™•ì„±
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ ì´í•´í•˜ê¸° ì‰¬ì›€
- [ ] ë¬¸ì„œ ì™„ì„±ë„ 90% ì´ìƒ

### Unified
- [ ] ëª¨ë“  ë‹¨ê³„ê°€ ì¼ê´€ëœ ë¡œê¹… í˜•ì‹
- [ ] ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™”
- [ ] ì„¤ì • íŒŒì¼ í˜•ì‹ ì¼ê´€ì„±

### Security
- [ ] config.json íŒŒì¼ ê¶Œí•œ í™•ì¸ (600)
- [ ] ìºì‹œ ë””ë ‰í† ë¦¬ ê¶Œí•œ ê²€ì¦
- [ ] ë¯¼ê° ì •ë³´ ë¡œê¹… ì•ˆ í•¨

### Trackable
- [ ] ê° ë‹¨ê³„ì˜ ì‹¤í–‰ ë¡œê·¸ ê¸°ë¡
- [ ] ì˜ì‚¬ê²°ì • í¬ì¸íŠ¸ ë¬¸ì„œí™”
- [ ] SPEC â†’ í…ŒìŠ¤íŠ¸ â†’ êµ¬í˜„ ì¶”ì 

---

## 7. ì„±ê³µ ê¸°ì¤€

### ê¸°ëŠ¥ì  ì„±ê³µ
- âœ… uvx moai-adk statusline ì •ìƒ ìž‘ë™
- âœ… Claude Code statuslineì— Ver 0.26.0 í‘œì‹œ
- âœ… "Ver unknown" ì™„ì „ ì œê±°

### ì„±ëŠ¥ ì„±ê³µ
- âœ… ì´ˆê¸° ì‹¤í–‰: 2ì´ˆ ì´ë‚´
- âœ… ìºì‹œ ížˆíŠ¸: 1ì´ˆ ì´ë‚´
- âœ… ë©”ëª¨ë¦¬ ì˜¤ë²„í—¤ë“œ < 50MB

### ì•ˆì •ì„± ì„±ê³µ
- âœ… ë©€í‹° ì„¸ì…˜ ë™ì‹œì„± ë³´ìž¥
- âœ… ìºì‹œ ì¶©ëŒ ì—†ìŒ
- âœ… ì˜¤ë¥˜ ë°œìƒ ì‹œ graceful fallback

---

**ê³„íš ìž‘ì„±ì¼**: 2025-11-18
**ìµœì¢… ê²€í† **: ì˜ˆì •
**ìƒíƒœ**: Draft
